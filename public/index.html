<!DOCTYPE html>
<html>
<head>
  <title>AnonyPost</title>
  <style type="text/css">
    .posts li {
      padding: 10px;
      list-style: 'none';
      border-bottom: 1px solid #eee;
    }

    .posts .content {
      font-family: 'comicsans';
      font-size: 20px;
    }

    .posts .created_at {
      font-variant: 'italic';
      font-size: 14px;
    }

    .posts .created_at:before {
      color: #666;
      content: 'Posted at   ';
      whitespace: 'pre'
    }
  </style>
  <script type="application/javascript" src="jquery-2.0.0.js"></script>
  <script type="application/javascript" src="handlebars-v1.3.0.js"></script>
  <script type="application/javascript" src="ember.js"></script>
  <script type="application/javascript">
    var Anonypost = Ember.Application.create()
    var App = Anonypost

  </script>
  <script type="application/javascript" src="ember-data.js"></script>

  <script type="application/javascript">
    App.Store = DS.Store.extend({
      adapter: DS.RESTAdapter.create()
    });

    Anonypost.Post = DS.Model.extend({
      content: DS.attr('string'),
      created_at: DS.attr('string'),

      net_upvotes: DS.attr('number')
    });

    Anonypost.Router.map(function() {
      this.resource('posts');
      this.resource('post', { path: '/post/:post_id' });
    })

    Anonypost.PostsRoute = Ember.Route.extend({
      model: function() {
        var stuff = App.Post.find()
        console.log(stuff)
        return stuff
      }//,

      // renderTemplate: function() {
      //   this.render('list', {   // the template to render
      //     into: 'application',                // the template to render into
      //     outlet: 'posts',              // the name of the outlet in that template
      //   });
      //
      //   this.render('comments', {
      //     into: 'application',
      //     outlet: 'papa',
      //   });
      // }
    })

    App.PostRoute = Ember.Route.extend({
      model: function(params) {
        console.log("I called this fucking function baby")
        console.log(params)
        var thing = App.Post.find(params.post_id);
        console.log(thing)
        console.log("Should have logged thing")
        return  thing
      }
    });

    Anonypost.ApplicationController = Ember.Controller.extend({firstName: 'Alex', lastName: 'Lerman'})

  </script>
</head>
<body>
  <script type="text/x-handlebars">
    <p>Before outlet</p>{{outlet mama}}<p>After outlet</p>
    <p>{{outlet}}</p>
  </script>

  <script type="text/x-handlebars" data-template-name="posts">
  {{outlet}}
  <ul class="posts">

  {{#each model}}
    {{#link-to 'post' id }}<li>
      <div class="content">{{content}}</div>
      <div class="created_at">{{created_at}}</div>
    </li>{{/link-to}}
  {{/each}}
  </ul>
  </script>

  <script type="text/x-handlebars" data-template-name='post'>
  {{#with model}}
    <div class="content">{{content}}</div>
    <div class="created_at">{{created_at}}</div>
  {{/with}}
  </script>
  <div id="posts"></div>
</body>
</html>
